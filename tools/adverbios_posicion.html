<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adverbios de Posición - Herramientas de Hindi</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        /* Tool-specific styles that are not in style.css */
        .game-container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        .visual-area {
            height: 300px;
            background-color: #eef;
            border-radius: 10px;
            position: relative;
            margin-bottom: 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* The Box */
        .box {
            width: 100px;
            height: 100px;
            background-color: #8B4513;
            /* SaddleBrown */
            border: 2px solid #5e2f0d;
            position: absolute;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
        }

        /* The Ball */
        .ball {
            width: 40px;
            height: 40px;
            background-color: #FF4500;
            /* OrangeRed */
            border-radius: 50%;
            position: absolute;
            z-index: 20;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
            transition: all 0.5s ease;
        }

        /* Scenario Classes */
        .scenario-ke-upar .ball {
            top: calc(50% - 50px - 40px - 5px);
            /* Center - half box - ball height - gap */
            left: 50%;
            transform: translateX(-50%);
        }

        .scenario-ke-niche .ball {
            top: calc(50% + 50px + 5px);
            /* Center + half box + gap */
            left: 50%;
            transform: translateX(-50%);
        }

        .scenario-ke-andar .ball {
            z-index: 5;
            /* Behind the front of the box, but we'll just make it look inside */
            background-color: #cc3700;
            /* Darker to simulate shadow */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Make the box look open or transparent for 'inside' */
        .scenario-ke-andar .box {
            background-color: rgba(139, 69, 19, 0.7);
            border-style: dashed;
        }

        .scenario-ke-bahar .ball {
            top: 50%;
            left: calc(50% + 50px + 40px);
            /* Center + half box + gap */
            transform: translateY(-50%);
        }

        .scenario-ke-samne .ball {
            z-index: 30;
            /* In front of box */
            top: calc(50% + 20px);
            left: calc(50% + 20px);
            transform: scale(1.2);
            /* Look closer */
        }

        .scenario-ke-piche .ball {
            z-index: 5;
            /* Behind box */
            top: calc(50% - 20px);
            left: calc(50% - 20px);
            opacity: 0.8;
        }

        .scenario-ke-pas .ball {
            top: 50%;
            left: calc(50% + 50px + 10px);
            /* Close to box */
            transform: translateY(-50%);
        }

        .scenario-se-dur .ball {
            top: 20px;
            left: 20px;
            /* Far corner */
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }

        .option-btn {
            background-color: white;
            border: 2px solid var(--primary-color);
            color: var(--text-color);
            padding: 1rem;
            border-radius: 8px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .option-btn:hover {
            background-color: #fff3e6;
        }

        .option-btn.correct {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }

        .option-btn.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .feedback {
            margin-top: 1.5rem;
            font-size: 1.2rem;
            font-weight: bold;
            min-height: 1.5em;
        }

        .score-board {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            color: #666;
        }

        .nav-btn {
            margin-top: 1rem;
            background-color: var(--accent-color);
        }

        .nav-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* Summary Table Styles */
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
            text-align: left;
        }

        .summary-table th,
        .summary-table td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        .summary-table th {
            background-color: var(--primary-color);
            color: white;
        }

        .summary-table tr:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>

<body>

    <!-- Fake Navbar to match React App -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="/#" class="navbar-brand">Curso de Hindi</a>
            <div class="nav-links">
                <a href="/#/" class="nav-link">Inicio</a>
                <a href="/#/programacion" class="nav-link">Programa</a>
                <a href="/#/curso" class="nav-link">Curso Completo</a>
                <a href="/#/practicas" class="nav-link">Prácticas</a>
                <a href="/#/herramientas" class="nav-link active">Herramientas</a>
            </div>
        </div>
    </nav>

    <main>
        <div class="game-container" id="study-view">
            <h1>Adverbios de Posición</h1>
            <h2>Repaso de Vocabulario</h2>
            <p>Estudia estas posiciones antes de empezar el juego.</p>

            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Hindi</th>
                        <th>Transliteración</th>
                        <th>Español</th>
                    </tr>
                </thead>
                <tbody id="vocab-list">
                    <!-- Vocab inserted by JS -->
                </tbody>
            </table>

            <button id="start-btn" class="btn nav-btn">¡Empezar Juego!</button>
        </div>

        <div class="game-container" id="game-view" style="display: none;">
            <div class="score-board">
                <span>Pregunta: <span id="current-q">1</span>/<span id="total-q">5</span></span>
                <span>Puntos: <span id="score">0</span></span>
            </div>

            <div class="visual-area" id="visual-area">
                <div class="box">CAJA</div>
                <div class="ball"></div>
            </div>

            <h3 id="instruction">¿Dónde está la bola?</h3>

            <div class="options-grid" id="options-container">
                <!-- Options will be injected here -->
            </div>

            <div class="feedback" id="feedback"></div>

            <button id="next-btn" class="btn nav-btn" style="display: none;">Siguiente &rarr;</button>
            <button id="restart-btn" class="btn nav-btn" style="display: none;">Volver al Repaso ↺</button>
        </div>
    </main>

    <script>
        const questions = [
            { id: 'ke-upar', answer: 'के ऊपर', translit: 'ke ūpar', meaning: 'Encima de' },
            { id: 'ke-niche', answer: 'के नीचे', translit: 'ke nīche', meaning: 'Debajo de' },
            { id: 'ke-andar', answer: 'के अंदर', translit: 'ke andar', meaning: 'Dentro de' },
            { id: 'ke-bahar', answer: 'के बाहर', translit: 'ke bāhar', meaning: 'Fuera de' },
            { id: 'ke-samne', answer: 'के सामने', translit: 'ke sāmne', meaning: 'En frente de' },
            { id: 'ke-piche', answer: 'के पीछे', translit: 'ke pīche', meaning: 'Detrás de' },
            { id: 'ke-pas', answer: 'के पास', translit: 'ke pās', meaning: 'Cerca de' },
            { id: 'se-dur', answer: 'से दूर', translit: 'se dūr', meaning: 'Lejos de' }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let shuffledQuestions = [];

        const studyView = document.getElementById('study-view');
        const gameView = document.getElementById('game-view');
        const vocabList = document.getElementById('vocab-list');
        const startBtn = document.getElementById('start-btn');

        const visualArea = document.getElementById('visual-area');
        const optionsContainer = document.getElementById('options-container');
        const feedbackEl = document.getElementById('feedback');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const currentQEl = document.getElementById('current-q');
        const totalQEl = document.getElementById('total-q');
        const scoreEl = document.getElementById('score');

        // Populate Summary Table
        function loadSummary() {
            vocabList.innerHTML = '';
            questions.forEach(q => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="hindi-text" style="font-size: 1.2em;">${q.answer}</td>
                    <td>${q.translit}</td>
                    <td>${q.meaning}</td>
                `;
                vocabList.appendChild(tr);
            });
        }

        function showGame() {
            studyView.style.display = 'none';
            gameView.style.display = 'block';
            initGame();
        }

        function showSummary() {
            gameView.style.display = 'none';
            studyView.style.display = 'block';
        }

        function initGame() {
            // Shuffle questions and pick 5 unique ones
            shuffledQuestions = [...questions];
            shuffledQuestions.sort(() => Math.random() - 0.5);
            shuffledQuestions = shuffledQuestions.slice(0, 5);

            currentQuestionIndex = 0;
            score = 0;
            scoreEl.textContent = score;
            totalQEl.textContent = shuffledQuestions.length;

            restartBtn.style.display = 'none';
            loadQuestion();
        }

        function loadQuestion() {
            const q = shuffledQuestions[currentQuestionIndex];
            currentQEl.textContent = currentQuestionIndex + 1;

            // Reset UI
            visualArea.className = 'visual-area scenario-' + q.id;
            optionsContainer.innerHTML = '';
            feedbackEl.textContent = '';
            feedbackEl.className = 'feedback';
            nextBtn.style.display = 'none';

            // Generate options (1 correct + 3 distractors)
            let options = [q];
            const distractors = questions.filter(item => item.id !== q.id);
            // Shuffle distractors and take 3
            distractors.sort(() => Math.random() - 0.5);
            options = options.concat(distractors.slice(0, 3));
            // Shuffle options
            options.sort(() => Math.random() - 0.5);

            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn hindi-text';
                btn.innerHTML = `<strong>${opt.answer}</strong><br><small style="font-family: var(--font-main); font-size: 0.8em;">(${opt.translit})</small>`;
                btn.onclick = () => checkAnswer(opt, q, btn);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selected, correct, btnElement) {
            // Disable all buttons
            const buttons = optionsContainer.querySelectorAll('button');
            buttons.forEach(b => b.disabled = true);

            if (selected.id === correct.id) {
                btnElement.classList.add('correct');
                feedbackEl.textContent = '¡Correcto! ' + correct.meaning;
                feedbackEl.style.color = 'var(--secondary-color)';
                score++;
                scoreEl.textContent = score;
            } else {
                btnElement.classList.add('incorrect');
                feedbackEl.textContent = 'Incorrecto. La respuesta era: ' + correct.answer + ' (' + correct.meaning + ')';
                feedbackEl.style.color = '#dc3545';
                // Highlight correct answer
                buttons.forEach(b => {
                    if (b.innerHTML.includes(correct.answer)) {
                        b.classList.add('correct');
                    }
                });
            }

            if (currentQuestionIndex < shuffledQuestions.length - 1) {
                nextBtn.style.display = 'inline-block';
            } else {
                restartBtn.style.display = 'inline-block';
                feedbackEl.textContent += ' - ¡Juego Terminado!';
            }
        }

        nextBtn.onclick = () => {
            currentQuestionIndex++;
            loadQuestion();
        };

        restartBtn.onclick = showSummary;
        startBtn.onclick = showGame;

        // Start
        loadSummary();
    </script>
</body>

</html>